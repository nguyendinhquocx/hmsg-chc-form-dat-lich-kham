<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Test - Ki·ªÉm tra Logic L·ªãch H·∫πn</title>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #ffffff;
            color: #000000;
        }
        .test-section {
            border: 1px solid #000000;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #000000;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            background: #f8f8f8;
            border-radius: 4px;
        }
        .code-block {
            background: #000000;
            color: #ffffff;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .highlight {
            background: #ffff00;
            color: #000000;
            padding: 2px 4px;
            border-radius: 2px;
        }
        .error {
            color: #d82c27;
            font-weight: 600;
        }
        .success {
            color: #28a745;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <h1>üîç Debug Test - V·∫•n ƒë·ªÅ Logic L·ªãch H·∫πn</h1>
    
    <div class="test-section">
        <div class="test-title">üìä T√¨nh hu·ªëng hi·ªán t·∫°i</div>
        <div class="test-item">
            <strong>C·∫•u h√¨nh:</strong> S√°ng t·ªëi ƒëa 10, Chi·ªÅu t·ªëi ƒëa 15
        </div>
        <div class="test-item">
            <strong>D·ªØ li·ªáu th·ª±c t·∫ø:</strong> Ng√†y 26/07/2025 c√≥ 12 h√†ng bu·ªïi s√°ng
        </div>
        <div class="test-item">
            <strong class="error">V·∫•n ƒë·ªÅ:</strong> V·∫´n cho ph√©p ƒëƒÉng k√Ω v√† th√™m d·ªØ li·ªáu v√†o b·∫£ng
        </div>
    </div>

    <div class="test-section">
        <div class="test-title">üîß C√°c ƒëi·ªÉm c·∫ßn ki·ªÉm tra</div>
        
        <div class="test-item">
            <strong>1. Ki·ªÉm tra Console Logs</strong>
            <p>M·ªü Developer Tools (F12) ‚Üí Console v√† th·ª±c hi·ªán test ƒë·ªÉ xem:</p>
            <div class="code-block">
Found columns - Date: X, Session: Y<br>
Searching for date: 2025-07-26, session: morning<br>
Row X: Date match - Original session: 'XXX', Normalized: 'XXX', Target: 'morning'<br>
Final count for 2025-07-26 morning: XX<br>
Checking availability: Date=2025-07-26, Session=morning, Count=XX, Limit=10
            </div>
        </div>

        <div class="test-item">
            <strong>2. Ki·ªÉm tra Headers trong Google Sheet</strong>
            <p>ƒê·∫£m b·∫£o c√≥ c·ªôt ch·ª©a t·ª´ kh√≥a:</p>
            <ul>
                <li><span class="highlight">"ng√†y" + "kh√°m"</span> (v√≠ d·ª•: "Ng√†y kh√°m", "Ng√†y h·∫πn kh√°m")</li>
                <li><span class="highlight">"bu·ªïi" + "kh√°m"</span> (v√≠ d·ª•: "Bu·ªïi kh√°m", "Bu·ªïi h·∫πn")</li>
            </ul>
        </div>

        <div class="test-item">
            <strong>3. Ki·ªÉm tra Gi√° tr·ªã trong C·ªôt Bu·ªïi Kh√°m</strong>
            <p>C√°c gi√° tr·ªã ƒë∆∞·ª£c h·ªó tr·ª£:</p>
            <ul>
                <li>"morning", "s√°ng", "bu·ªïi s√°ng" ‚Üí <span class="success">morning</span></li>
                <li>"afternoon", "chi·ªÅu", "bu·ªïi chi·ªÅu" ‚Üí <span class="success">afternoon</span></li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <div class="test-title">üöÄ C√°ch Debug</div>
        
        <div class="test-item">
            <strong>B∆∞·ªõc 1:</strong> M·ªü Google Apps Script Editor
        </div>
        <div class="test-item">
            <strong>B∆∞·ªõc 2:</strong> Ch·∫°y function test n√†y:
            <div class="code-block">
function debugAppointmentCount() {<br>
&nbsp;&nbsp;const result = getAppointmentCount('2025-07-26', 'morning');<br>
&nbsp;&nbsp;console.log('Debug result:', result);<br>
&nbsp;&nbsp;return result;<br>
}
            </div>
        </div>
        <div class="test-item">
            <strong>B∆∞·ªõc 3:</strong> Ki·ªÉm tra Execution Transcript ƒë·ªÉ xem logs
        </div>
        <div class="test-item">
            <strong>B∆∞·ªõc 4:</strong> Ki·ªÉm tra d·ªØ li·ªáu th·ª±c t·∫ø trong Google Sheet
        </div>
    </div>

    <div class="test-section">
        <div class="test-title">üîç C√°c nguy√™n nh√¢n c√≥ th·ªÉ</div>
        
        <div class="test-item">
            <strong class="error">1. Kh√¥ng t√¨m th·∫•y c·ªôt:</strong> Headers kh√¥ng ch·ª©a t·ª´ kh√≥a ƒë√∫ng
        </div>
        <div class="test-item">
            <strong class="error">2. Gi√° tr·ªã kh√¥ng kh·ªõp:</strong> D·ªØ li·ªáu trong sheet kh√°c v·ªõi expected values
        </div>
        <div class="test-item">
            <strong class="error">3. Format ng√†y:</strong> Ng√†y trong sheet kh√¥ng ƒë√∫ng format
        </div>
        <div class="test-item">
            <strong class="error">4. Logic validation:</strong> H√†m validateAndSaveFormData kh√¥ng ƒë∆∞·ª£c g·ªçi
        </div>
    </div>

    <div class="test-section">
        <div class="test-title">‚úÖ Gi·∫£i ph√°p ƒë√£ √°p d·ª•ng</div>
        
        <div class="test-item">
            <span class="success">‚úì</span> Th√™m h√†m normalizeSessionValue() ƒë·ªÉ chu·∫©n h√≥a gi√° tr·ªã bu·ªïi kh√°m
        </div>
        <div class="test-item">
            <span class="success">‚úì</span> Th√™m debug logging ƒë·ªÉ theo d√µi qu√° tr√¨nh
        </div>
        <div class="test-item">
            <span class="success">‚úì</span> C·∫£i thi·ªán logic so s√°nh trong getAppointmentCount()
        </div>
        <div class="test-item">
            <span class="success">‚úì</span> Th√™m validation trong checkAppointmentAvailability()
        </div>
    </div>

    <div class="test-section">
        <div class="test-title">üìù H∆∞·ªõng d·∫´n Test</div>
        
        <div class="test-item">
            <strong>1.</strong> Deploy l·∫°i Google Apps Script v·ªõi code ƒë√£ c·∫≠p nh·∫≠t
        </div>
        <div class="test-item">
            <strong>2.</strong> M·ªü form v√† th·ª≠ ch·ªçn ng√†y 26/07/2025, bu·ªïi s√°ng
        </div>
        <div class="test-item">
            <strong>3.</strong> M·ªü Developer Tools (F12) ‚Üí Console
        </div>
        <div class="test-item">
            <strong>4.</strong> Quan s√°t c√°c log messages ƒë·ªÉ hi·ªÉu v·∫•n ƒë·ªÅ
        </div>
        <div class="test-item">
            <strong>5.</strong> B√°o c√°o k·∫øt qu·∫£ ƒë·ªÉ ƒëi·ªÅu ch·ªânh ti·∫øp
        </div>
    </div>

    <p style="margin-top: 30px; text-align: center; color: #666;">
        üí° <strong>L∆∞u √Ω:</strong> Sau khi test, h√£y chia s·∫ª console logs ƒë·ªÉ ch√∫ng ta c√≥ th·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c nguy√™n nh√¢n.
    </p>
</body>
</html>